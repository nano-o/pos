<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory Casper</title>
</head>


<body>
<div class="head">
<h1>Theory Casper</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><a href="Casper.html"><span>Casper</span></a><span>
  </span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span> </span><a href="../../HOL/HOL/Main.html"><span>Main</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Here we prove that the slashing conditions in Casper, as described at the url below by Vitalik Buterin, 
are such that if there is a fork, then one third of the validators are "slashed".
</span><span class="antiquoted"><span class="operator"><span>🌐</span></span><a href="https://medium.com/@VitalikButerin/minimal-slashing-conditions-20f0b500fc6c"><span>‹https://medium.com/@VitalikButerin/minimal-slashing-conditions-20f0b500fc6c›</span></a></span><span> ›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹ We use first-order modeling as much as possible. This allows to reduce the size of the model, 
  and also the size of the proofs from more than 1000 lines in Yoichi's proof to less than a 100. ›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Casper.byz_quorums.intro|fact"><span class="entity_def" id="Casper.byz_quorums_def|fact"><span class="entity_def" id="Casper.byz_quorums.intro|thm"><span class="entity_def" id="Casper.byz_quorums_def|thm"><span class="entity_def" id="Casper.byz_quorums_def|axiom"><span>locale</span></span></span></span></span></span></span></span><span> </span><span class="entity_def" id="Casper.byz_quorums|locale"><span class="entity_def" id="Casper.byz_quorums|const"><span class="entity_def" id="offset_522..533">byz_quorums</span></span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="comment1"><span>― ‹ "Here we fix two types </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>typ</span></span><span> </span><span class="quoted"><span class="tfree"><span>'q1</span></span></span><span class="antiquote"><span>}</span></span></span><span> and </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>typ</span></span><span> </span><span class="quoted"><span class="tfree"><span>'q2</span></span></span><span class="antiquote"><span>}</span></span></span><span> for quorums of cardinality greater than 2/3 of 
the validators and quorum of cardinality greater than 1/3 of the validators.›</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>member_1</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'n</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'q1</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.bool|type"><span>bool</span></a><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>infix</span></span></span><span> </span><span class="quoted"><span>"</span><span class="keyword1"><span class="keyword1"><span>∈<span class="hidden">⇩</span><sub>1</sub></span></span></span><span>"</span></span><span> 50</span><span class="main"><span>)</span></span><span>
    </span><span class="comment1"><span>― ‹ Membership in 2/3 set›</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="free"><span>member_2</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'n</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'q2</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.bool|type"><span>bool</span></a><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>infix</span></span></span><span> </span><span class="quoted"><span>"</span><span class="keyword1"><span class="keyword1"><span>∈<span class="hidden">⇩</span><sub>2</sub></span></span></span><span>"</span></span><span> 50</span><span class="main"><span>)</span></span><span>
    </span><span class="comment1"><span>― ‹ Membership in 1/3 set›</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span> </span><span class="bound"><span>q1</span></span><span> </span><span class="bound"><span>q2</span></span><span> </span><span class="main"><span>.</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>∃</span></a></span><span> </span><span class="bound"><span>q3</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="main"><span class="free"><span>∈<span class="hidden">⇩</span><sub>2</sub></span></span></span><span> </span><span class="bound"><span>q3</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="main"><span class="free"><span>∈<span class="hidden">⇩</span><sub>1</sub></span></span></span><span> </span><span class="bound"><span>q1</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="main"><span class="free"><span>∈<span class="hidden">⇩</span><sub>1</sub></span></span></span><span> </span><span class="bound"><span>q2</span></span><span>"</span></span></span><span>  
    </span><span class="comment1"><span>― ‹ This is the only property of types </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>typ</span></span><span> </span><span class="quoted"><span class="tfree"><span>'q1</span></span></span><span class="antiquote"><span>}</span></span></span><span> and </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>typ</span></span><span> </span><span class="quoted"><span class="tfree"><span>'q2</span></span></span><span class="antiquote"><span>}</span></span></span><span> that we need: 
2/3 quorums have 1/3 intersection›</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Casper.state.arity_full_exhaustive_state_ext|fact"><span class="entity_def" id="Casper.state.full_exhaustive_state_ext_def|fact"><span class="entity_def" id="Casper.state.full_exhaustive_state_ext_inst.full_exhaustive_state_ext|fact"><span class="entity_def" id="Casper.state.arity_random_state_ext|fact"><span class="entity_def" id="Casper.state.random_state_ext_def|fact"><span class="entity_def" id="Casper.state.random_state_ext_inst.random_state_ext|fact"><span class="entity_def" id="Casper.state.arity_equal_state_ext|fact"><span class="entity_def" id="Casper.state.equal_state_ext_def|fact"><span class="entity_def" id="Casper.state.equal_state_ext_inst.equal_state_ext|fact"><span class="entity_def" id="Casper.state.arity_partial_term_of_state_ext|fact"><span class="entity_def" id="Casper.state.partial_term_of_state_ext_triv|fact"><span class="entity_def" id="Casper.state.partial_term_of_state_ext_inst.partial_term_of_state_ext|fact"><span class="entity_def" id="Casper.state.arity_term_of_state_ext|fact"><span class="entity_def" id="Casper.state.term_of_state_ext_triv|fact"><span class="entity_def" id="Casper.state.term_of_state_ext_inst.term_of_state_ext|fact"><span class="entity_def" id="Casper.state.iffs|fact"><span class="entity_def" id="Casper.state.simps|fact"><span class="entity_def" id="Casper.state.cases|fact"><span class="entity_def" id="Casper.state.cases_scheme|fact"><span class="entity_def" id="Casper.state.induct|fact"><span class="entity_def" id="Casper.state.induct_scheme|fact"><span class="entity_def" id="Casper.state.equality|fact"><span class="entity_def" id="Casper.state.surjective|fact"><span class="entity_def" id="Casper.state.defs|fact"><span class="entity_def" id="Casper.state.splits|fact"><span class="entity_def" id="Casper.state.unfold_congs|fact"><span class="entity_def" id="Casper.state.fold_congs|fact"><span class="entity_def" id="Casper.state.update_defs|fact"><span class="entity_def" id="Casper.state.select_defs|fact"><span class="entity_def" id="Casper.state.update_convs|fact"><span class="entity_def" id="Casper.state.select_convs|fact"><span class="entity_def" id="Casper.state.truncate_def|fact"><span class="entity_def" id="Casper.state.extend_def|fact"><span class="entity_def" id="Casper.state.fields_def|fact"><span class="entity_def" id="Casper.state.make_def|fact"><span class="entity_def" id="Casper.state.more_update_def|fact"><span class="entity_def" id="Casper.state.prepare_msg_update_def|fact"><span class="entity_def" id="Casper.state.commit_msg_update_def|fact"><span class="entity_def" id="Casper.state.more_def|fact"><span class="entity_def" id="Casper.state.prepare_msg_def|fact"><span class="entity_def" id="Casper.state.commit_msg_def|fact"><span class="entity_def" id="Casper.state.ext_split|fact"><span class="entity_def" id="Casper.state.ext_surjective|fact"><span class="entity_def" id="Casper.state.ext_inject|fact"><span class="entity_def" id="Casper.state.ext_induct|fact"><span class="entity_def" id="Casper.state.state_ext_def|fact"><span class="entity_def" id="Casper.state.state_ext.state_ext_Tuple_Iso_def|fact"><span class="entity_def" id="Casper.state.arity_typerep_state_ext|fact"><span class="entity_def" id="Casper.state.typerep_state_ext_def|fact"><span class="entity_def" id="Casper.state.typerep_state_ext_inst.typerep_state_ext|fact"><span class="entity_def" id="Casper.state.state_ext.Abs_state_ext_induct|fact"><span class="entity_def" id="Casper.state.state_ext.Rep_state_ext_induct|fact"><span class="entity_def" id="Casper.state.state_ext.Abs_state_ext_cases|fact"><span class="entity_def" id="Casper.state.state_ext.Rep_state_ext_cases|fact"><span class="entity_def" id="Casper.state.state_ext.Abs_state_ext_inject|fact"><span class="entity_def" id="Casper.state.state_ext.Rep_state_ext_inject|fact"><span class="entity_def" id="Casper.state.state_ext.Abs_state_ext_inverse|fact"><span class="entity_def" id="Casper.state.state_ext.Rep_state_ext_inverse|fact"><span class="entity_def" id="Casper.state.state_ext.Rep_state_ext|fact"><span class="entity_def" id="Casper.state.state_ext.type_definition_state_ext|fact"><span class="entity_def" id="Casper.state.arity_type_state_ext|fact"><span class="entity_def" id="Casper.state.arity_full_exhaustive_state_ext|thm"><span class="entity_def" id="Casper.state.full_exhaustive_state_ext_def|thm"><span class="entity_def" id="Casper.state.full_exhaustive_state_ext_inst.full_exhaustive_state_ext|thm"><span class="entity_def" id="Casper.state.arity_random_state_ext|thm"><span class="entity_def" id="Casper.state.random_state_ext_def|thm"><span class="entity_def" id="Casper.state.random_state_ext_inst.random_state_ext|thm"><span class="entity_def" id="Casper.state.arity_equal_state_ext|thm"><span class="entity_def" id="Casper.state.equal_state_ext_def|thm"><span class="entity_def" id="Casper.state.equal_state_ext_inst.equal_state_ext|thm"><span class="entity_def" id="Casper.state.arity_partial_term_of_state_ext|thm"><span class="entity_def" id="Casper.state.partial_term_of_state_ext_triv|thm"><span class="entity_def" id="Casper.state.partial_term_of_state_ext_inst.partial_term_of_state_ext|thm"><span class="entity_def" id="Casper.state.arity_term_of_state_ext|thm"><span class="entity_def" id="Casper.state.term_of_state_ext_triv|thm"><span class="entity_def" id="Casper.state.term_of_state_ext_inst.term_of_state_ext|thm"><span class="entity_def" id="Casper.state.iffs|thm"><span class="entity_def" id="Casper.state.simps(6)|thm"><span class="entity_def" id="Casper.state.simps(5)|thm"><span class="entity_def" id="Casper.state.simps(4)|thm"><span class="entity_def" id="Casper.state.simps(3)|thm"><span class="entity_def" id="Casper.state.simps(2)|thm"><span class="entity_def" id="Casper.state.simps(1)|thm"><span class="entity_def" id="Casper.state.cases|thm"><span class="entity_def" id="Casper.state.cases_scheme|thm"><span class="entity_def" id="Casper.state.induct|thm"><span class="entity_def" id="Casper.state.induct_scheme|thm"><span class="entity_def" id="Casper.state.equality|thm"><span class="entity_def" id="Casper.state.surjective|thm"><span class="entity_def" id="Casper.state.defs(4)|thm"><span class="entity_def" id="Casper.state.defs(3)|thm"><span class="entity_def" id="Casper.state.defs(2)|thm"><span class="entity_def" id="Casper.state.defs(1)|thm"><span class="entity_def" id="Casper.state.splits(3)|thm"><span class="entity_def" id="Casper.state.splits(2)|thm"><span class="entity_def" id="Casper.state.splits(1)|thm"><span class="entity_def" id="Casper.state.unfold_congs(3)|thm"><span class="entity_def" id="Casper.state.unfold_congs(2)|thm"><span class="entity_def" id="Casper.state.unfold_congs(1)|thm"><span class="entity_def" id="Casper.state.fold_congs(3)|thm"><span class="entity_def" id="Casper.state.fold_congs(2)|thm"><span class="entity_def" id="Casper.state.fold_congs(1)|thm"><span class="entity_def" id="Casper.state.update_defs(3)|thm"><span class="entity_def" id="Casper.state.update_defs(2)|thm"><span class="entity_def" id="Casper.state.update_defs(1)|thm"><span class="entity_def" id="Casper.state.select_defs(3)|thm"><span class="entity_def" id="Casper.state.select_defs(2)|thm"><span class="entity_def" id="Casper.state.select_defs(1)|thm"><span class="entity_def" id="Casper.state.update_convs(3)|thm"><span class="entity_def" id="Casper.state.update_convs(2)|thm"><span class="entity_def" id="Casper.state.update_convs(1)|thm"><span class="entity_def" id="Casper.state.select_convs(3)|thm"><span class="entity_def" id="Casper.state.select_convs(2)|thm"><span class="entity_def" id="Casper.state.select_convs(1)|thm"><span class="entity_def" id="Casper.state.truncate_def|thm"><span class="entity_def" id="Casper.state.extend_def|thm"><span class="entity_def" id="Casper.state.fields_def|thm"><span class="entity_def" id="Casper.state.make_def|thm"><span class="entity_def" id="Casper.state.more_update_def|thm"><span class="entity_def" id="Casper.state.prepare_msg_update_def|thm"><span class="entity_def" id="Casper.state.commit_msg_update_def|thm"><span class="entity_def" id="Casper.state.more_def|thm"><span class="entity_def" id="Casper.state.prepare_msg_def|thm"><span class="entity_def" id="Casper.state.commit_msg_def|thm"><span class="entity_def" id="Casper.state.ext_split|thm"><span class="entity_def" id="Casper.state.ext_surjective|thm"><span class="entity_def" id="Casper.state.ext_inject|thm"><span class="entity_def" id="Casper.state.ext_induct|thm"><span class="entity_def" id="Casper.state.state_ext_def|thm"><span class="entity_def" id="Casper.state.state_ext.state_ext_Tuple_Iso_def|thm"><span class="entity_def" id="Casper.state.arity_typerep_state_ext|thm"><span class="entity_def" id="Casper.state.typerep_state_ext_def|thm"><span class="entity_def" id="Casper.state.typerep_state_ext_inst.typerep_state_ext|thm"><span class="entity_def" id="Casper.state.state_ext.Abs_state_ext_induct|thm"><span class="entity_def" id="Casper.state.state_ext.Rep_state_ext_induct|thm"><span class="entity_def" id="Casper.state.state_ext.Abs_state_ext_cases|thm"><span class="entity_def" id="Casper.state.state_ext.Rep_state_ext_cases|thm"><span class="entity_def" id="Casper.state.state_ext.Abs_state_ext_inject|thm"><span class="entity_def" id="Casper.state.state_ext.Rep_state_ext_inject|thm"><span class="entity_def" id="Casper.state.state_ext.Abs_state_ext_inverse|thm"><span class="entity_def" id="Casper.state.state_ext.Rep_state_ext_inverse|thm"><span class="entity_def" id="Casper.state.state_ext.Rep_state_ext|thm"><span class="entity_def" id="Casper.state.state_ext.type_definition_state_ext|thm"><span class="entity_def" id="Casper.state.arity_type_state_ext|thm"><span class="entity_def" id="Casper.state.full_exhaustive_state_ext_def_raw|axiom"><span class="entity_def" id="Casper.state.full_exhaustive_state_ext_inst.full_exhaustive_state_ext_def|axiom"><span class="entity_def" id="Casper.state.random_state_ext_def_raw|axiom"><span class="entity_def" id="Casper.state.random_state_ext_inst.random_state_ext_def|axiom"><span class="entity_def" id="Casper.state.equal_state_ext_def_raw|axiom"><span class="entity_def" id="Casper.state.equal_state_ext_inst.equal_state_ext_def|axiom"><span class="entity_def" id="Casper.state.partial_term_of_state_ext_triv_raw|axiom"><span class="entity_def" id="Casper.state.partial_term_of_state_ext_inst.partial_term_of_state_ext_def|axiom"><span class="entity_def" id="Casper.state.term_of_state_ext_triv_raw|axiom"><span class="entity_def" id="Casper.state.term_of_state_ext_inst.term_of_state_ext_def|axiom"><span class="entity_def" id="Casper.state.truncate_def|axiom"><span class="entity_def" id="Casper.state.extend_def|axiom"><span class="entity_def" id="Casper.state.fields_def|axiom"><span class="entity_def" id="Casper.state.make_def|axiom"><span class="entity_def" id="Casper.state.more_update_def|axiom"><span class="entity_def" id="Casper.state.prepare_msg_update_def|axiom"><span class="entity_def" id="Casper.state.commit_msg_update_def|axiom"><span class="entity_def" id="Casper.state.more_def|axiom"><span class="entity_def" id="Casper.state.prepare_msg_def|axiom"><span class="entity_def" id="Casper.state.commit_msg_def|axiom"><span class="entity_def" id="Casper.state.state_ext_def|axiom"><span class="entity_def" id="Casper.state.state_ext.state_ext_Tuple_Iso_def|axiom"><span class="entity_def" id="Casper.state.typerep_state_ext_def_raw|axiom"><span class="entity_def" id="Casper.state.typerep_state_ext_inst.typerep_state_ext_def|axiom"><span class="entity_def" id="Casper.state.state_ext.type_definition_state_ext|axiom"><span class="entity_def" id="Casper.state.arity_type_state_ext|axiom"><span class="entity_def" id="Casper.state.full_exhaustive_state_ext_inst.full_exhaustive_state_ext|const"><span class="entity_def" id="Casper.state.random_state_ext_inst.random_state_ext|const"><span class="entity_def" id="Casper.state.equal_state_ext_inst.equal_state_ext|const"><span class="entity_def" id="Casper.state.partial_term_of_state_ext_inst.partial_term_of_state_ext|const"><span class="entity_def" id="Casper.state.term_of_state_ext_inst.term_of_state_ext|const"><span class="entity_def" id="Casper.state.truncate|const"><span class="entity_def" id="Casper.state.extend|const"><span class="entity_def" id="Casper.state.fields|const"><span class="entity_def" id="Casper.state.make|const"><span class="entity_def" id="Casper.state.more_update|const"><span class="entity_def" id="Casper.state.prepare_msg_update|const"><span class="entity_def" id="Casper.state.commit_msg_update|const"><span class="entity_def" id="Casper.state.more|const"><span class="entity_def" id="Casper.state.prepare_msg|const"><span class="entity_def" id="Casper.state.commit_msg|const"><span class="entity_def" id="Casper.state.state_ext|const"><span class="entity_def" id="Casper.state.state_ext.state_ext_Tuple_Iso|const"><span class="entity_def" id="Casper.state.typerep_state_ext_inst.typerep_state_ext|const"><span class="entity_def" id="Casper.state.state_ext.Abs_state_ext|const"><span class="entity_def" id="Casper.state.state_ext.Rep_state_ext|const"><span class="entity_def" id="Casper.state.state_ext|type"><span>record</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="tfree"><span>'n</span></span><span class="main"><span>,</span></span><span class="tfree"><span>'h</span></span><span class="main"><span>)</span></span><span class="entity_def" id="Casper.state_scheme|type"><span class="entity_def" id="Casper.state|type"><span>state</span></span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="comment1"><span>― ‹ "</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>typ</span></span><span> </span><span class="quoted"><span class="tfree"><span>'n</span></span></span><span class="antiquote"><span>}</span></span></span><span> is the type of validators (nodes), </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>typ</span></span><span> </span><span class="quoted"><span class="tfree"><span>'h</span></span></span><span class="antiquote"><span>}</span></span></span><span> hashes, and views are </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>typ</span></span><span> </span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a></span><span class="antiquote"><span>}</span></span></span><span>›</span></span><span>
  commit_msg </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'n</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'h</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.bool|type"><span>bool</span></a><span>"</span></span></span><span>
  prepare_msg </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'n</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'h</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.bool|type"><span>bool</span></a><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Casper.casper.axioms|fact"><span class="entity_def" id="Casper.casper.intro|fact"><span class="entity_def" id="Casper.casper_def|fact"><span class="entity_def" id="Casper.casper_axioms.intro|fact"><span class="entity_def" id="Casper.casper_axioms_def|fact"><span class="entity_def" id="Casper.casper.axioms(2)|thm"><span class="entity_def" id="Casper.casper.axioms(1)|thm"><span class="entity_def" id="Casper.casper.intro|thm"><span class="entity_def" id="Casper.casper_def|thm"><span class="entity_def" id="Casper.casper_axioms.intro|thm"><span class="entity_def" id="Casper.casper_axioms_def|thm"><span class="entity_def" id="Casper.casper_def|axiom"><span class="entity_def" id="Casper.casper_axioms_def|axiom"><span>locale</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity_def" id="Casper.casper|locale"><span class="entity_def" id="Casper.casper|const"><span class="entity_def" id="Casper.casper_axioms|const"><span class="entity_def" id="offset_1288..1294">casper</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Casper.html#Casper.byz_quorums|locale"><span>byz_quorums</span></a><span> </span><span class="main"><span>+</span></span><span>
  </span><span class="comment1"><span>― ‹ Here we make assumptions about hashes. In reality any message containing a hash not satisfying those
should be dropped.›</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> 
  </span><span class="free"><span>hash_parent</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'h</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'h</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.bool|type"><span>bool</span></a><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>infix</span></span></span><span> </span><span class="quoted"><span>"</span><span class="keyword1"><span>←</span></span><span>"</span></span><span> 50</span><span class="main"><span>)</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span>
  </span><span class="comment1"><span>― ‹ "a hash has at most one parent which is not itself›</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span> </span><span class="bound"><span>h1</span></span><span> </span><span class="bound"><span>h2</span></span><span> </span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>h1</span></span><span> </span><span class="main"><span class="free"><span>←</span></span></span><span> </span><span class="bound"><span>h2</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="bound"><span>h1</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span> </span><span class="bound"><span>h2</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span> </span><span class="bound"><span>h1</span></span><span> </span><span class="bound"><span>h2</span></span><span> </span><span class="bound"><span>h3</span></span><span> </span><span class="main"><span>.</span></span><span> </span><span class="main"><span>⟦</span></span><span class="bound"><span>h2</span></span><span> </span><span class="main"><span class="free"><span>←</span></span></span><span> </span><span class="bound"><span>h1</span></span><span class="main"><span>;</span></span><span> </span><span class="bound"><span>h3</span></span><span> </span><span class="main"><span class="free"><span>←</span></span></span><span> </span><span class="bound"><span>h1</span></span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="bound"><span>h2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="bound"><span>h3</span></span><span>"</span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemmas</span></span></span><span> </span><span class="entity_def" id="Casper.casper.casper_assms_def|fact"><span class="entity_def" id="Casper.casper.casper_assms_def(3)|thm"><span class="entity_def" id="Casper.casper.casper_assms_def(2)|thm"><span class="entity_def" id="Casper.casper.casper_assms_def(1)|thm"><span class="entity_def" id="offset_1656..1672">casper_assms_def</span></span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Casper.html#Casper.casper_def|fact"><span>casper_def</span></a><span> </span><a class="entity_ref" href="Casper.html#Casper.casper_axioms_def|fact"><span>casper_axioms_def</span></a><span> </span><a class="entity_ref" href="Casper.html#Casper.byz_quorums_def|fact"><span>byz_quorums_def</span></a><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Casper.casper.hash_ancestor.inducts|fact"><span class="entity_def" id="Casper.casper.hash_ancestor.simps|fact"><span class="entity_def" id="Casper.casper.hash_ancestor.induct|fact"><span class="entity_def" id="Casper.casper.hash_ancestor.cases|fact"><span class="entity_def" id="Casper.casper.hash_ancestor.intros|fact"><span class="entity_def" id="Casper.casper.hash_ancestor.inducts|thm"><span class="entity_def" id="Casper.casper.hash_ancestor.simps|thm"><span class="entity_def" id="Casper.casper.hash_ancestor.induct|thm"><span class="entity_def" id="Casper.casper.hash_ancestor.cases|thm"><span class="entity_def" id="Casper.casper.hash_ancestor.intros(2)|thm"><span class="entity_def" id="Casper.casper.hash_ancestor.intros(1)|thm"><span class="entity_def" id="Casper.casper.hash_ancestor_def|axiom"><span class="entity_def" id="offset_1721..1730">inductive</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Casper.casper.hash_ancestor.cong|fact"><span class="entity_def" id="Casper.casper.hash_ancestor.cong|thm"><span class="entity_def" id="Casper.casper.hash_ancestor|const"><span class="entity_def" id="offset_1731..1744">hash_ancestor</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>infix</span></span></span><span> </span><span class="quoted"><span>"</span><span class="keyword1"><span>←<span class="hidden">⇧</span><sup>*</sup></span></span><span>"</span></span><span> 50</span><span class="main"><span>)</span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> 
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="bound"><span class="entity"><span>h1</span></span></span></span><span> </span><span class="main"><span class="free"><span>←</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h2</span></span></span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h1</span></span></span></span><span> </span><span class="main"><span class="free"><span>←<span class="hidden">⇧</span><sup>*</sup></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h2</span></span></span></span><span>"</span></span></span><span>
</span><span class="main"><span>|</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span class="free"><span class="bound"><span class="entity"><span>h1</span></span></span></span><span> </span><span class="main"><span class="free"><span>←</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h2</span></span></span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h2</span></span></span></span><span> </span><span class="main"><span class="free"><span>←<span class="hidden">⇧</span><sup>*</sup></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h3</span></span></span></span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h1</span></span></span></span><span> </span><span class="main"><span class="free"><span>←<span class="hidden">⇧</span><sup>*</sup></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h3</span></span></span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>declare</span></span></span><span> </span><a class="entity_ref" href="Casper.html#offset_1721..1730"><span>hash_ancestor.intros</span></a><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>,</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.intro|attribute"><span class="operator"><span>intro</span></span></a><span class="main"><span>]</span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_1871..1876">lemma</span></span></span><span> </span><span class="entity_def" id="Casper.casper.hash_ancestor_intro&apos;|fact"><span class="entity_def" id="Casper.casper.hash_ancestor_intro&apos;|thm"><span class="entity_def" id="offset_1877..1897">hash_ancestor_intro'</span></span></span><span class="main"><span>:</span></span><span> </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>h1</span></span><span> </span><span class="main"><a class="entity_ref" href="Casper.html#offset_1731..1744"><span>←<span class="hidden">⇧</span><sup>*</sup></span></a></span><span> </span><span class="free"><span>h2</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>h2</span></span><span> </span><span class="main"><span class="free"><span>←</span></span></span><span> </span><span class="free"><span>h3</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>h1</span></span><span> </span><span class="main"><a class="entity_ref" href="Casper.html#offset_1731..1744"><span>←<span class="hidden">⇧</span><sup>*</sup></span></a></span><span> </span><span class="free"><span>h3</span></span><span>"</span></span></span><span> 
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Casper.html#offset_1871..1876"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.induct|method"><span class="operator"><span>induct</span></span></a><span> </span><span class="quoted"><span class="free"><span>h1</span></span></span><span> </span><span class="quoted"><span class="free"><span>h2</span></span></span><span> </span><span class="quasi_keyword"><span>rule</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Casper.html#offset_1721..1730"><span>hash_ancestor.induct</span></a><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Casper.casper.nth_ancestor.inducts|fact"><span class="entity_def" id="Casper.casper.nth_ancestor.simps|fact"><span class="entity_def" id="Casper.casper.nth_ancestor.induct|fact"><span class="entity_def" id="Casper.casper.nth_ancestor.cases|fact"><span class="entity_def" id="Casper.casper.nth_ancestor.intros|fact"><span class="entity_def" id="Casper.casper.nth_ancestor.inducts|thm"><span class="entity_def" id="Casper.casper.nth_ancestor.simps|thm"><span class="entity_def" id="Casper.casper.nth_ancestor.induct|thm"><span class="entity_def" id="Casper.casper.nth_ancestor.cases|thm"><span class="entity_def" id="Casper.casper.nth_ancestor.intros(2)|thm"><span class="entity_def" id="Casper.casper.nth_ancestor.intros(1)|thm"><span class="entity_def" id="Casper.casper.nth_ancestor_def|axiom"><span class="entity_def" id="offset_2016..2025">inductive</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Casper.casper.nth_ancestor.cong|fact"><span class="entity_def" id="Casper.casper.nth_ancestor.cong|thm"><span class="entity_def" id="Casper.casper.nth_ancestor|const"><span class="entity_def" id="offset_2026..2038">nth_ancestor</span></span></span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'h</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'h</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.bool|type"><span>bool</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> 
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>nth_ancestor</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h1</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h1</span></span></span></span><span>"</span></span></span><span>
</span><span class="main"><span>|</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><span class="free"><span>nth_ancestor</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h1</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h2</span></span></span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h2</span></span></span></span><span> </span><span class="main"><span class="free"><span>←</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h3</span></span></span></span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>nth_ancestor</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h1</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h3</span></span></span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>declare</span></span></span><span> </span><a class="entity_ref" href="Casper.html#offset_2016..2025"><span>nth_ancestor.intros</span></a><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>,</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.intro|attribute"><span class="operator"><span>intro</span></span></a><span class="main"><span>]</span></span><span>
</span><span class="keyword1"><span class="command"><span>inductive_cases</span></span></span><span> </span><span class="entity_def" id="Casper.casper.nth_ancestor_succ|fact"><span class="entity_def" id="Casper.casper.nth_ancestor_succ|thm"><span class="entity_def" id="offset_2216..2233">nth_ancestor_succ</span></span></span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Casper.html#offset_2026..2038"><span>nth_ancestor</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>h1</span></span><span> </span><span class="free"><span>h3</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>inductive_cases</span></span></span><span> </span><span class="entity_def" id="Casper.casper.zeroth_ancestor|fact"><span class="entity_def" id="Casper.casper.zeroth_ancestor|thm"><span class="entity_def" id="offset_2277..2292">zeroth_ancestor</span></span></span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Casper.html#offset_2026..2038"><span>nth_ancestor</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="free"><span>h1</span></span><span> </span><span class="free"><span>h3</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Casper.casper.parent_ancestor|fact"><span class="entity_def" id="Casper.casper.parent_ancestor|thm"><span>parent_ancestor</span></span></span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>h1</span></span><span> </span><span class="main"><span class="free"><span>←</span></span></span><span> </span><span class="free"><span>h2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Casper.html#offset_2026..2038"><span>nth_ancestor</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="free"><span>h1</span></span><span> </span><span class="free"><span>h2</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.One_nat_def|fact"><span>One_nat_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.monoid_add_class.add.right_neutral|fact"><span>add.right_neutral</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.add_Suc_right|fact"><span>add_Suc_right</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.cancel_ab_semigroup_add_class.add_diff_cancel_left&apos;|fact"><span>add_diff_cancel_left'</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.diff_Suc_Suc|fact"><span>diff_Suc_Suc</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat.simps|fact"><span>nat.simps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>3</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Casper.html#offset_2016..2025"><span>nth_ancestor.simps</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹ All messages in epoch </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>::</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span>"</span></span><span class="antiquote"><span>}</span></span></span><span> are ignored;  </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>::</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span>"</span></span><span class="antiquote"><span>}</span></span></span><span> is used as a special value (was </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.uminus_class.uminus|const"><span>-</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>::</span></span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|type"><span>int</span></a><span>"</span></span><span class="antiquote"><span>}</span></span></span><span> in the original model). ›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Casper.casper.prepared&apos;_def|fact"><span class="entity_def" id="Casper.casper.prepared&apos;_def|thm"><span class="entity_def" id="Casper.casper.prepared&apos;_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Casper.casper.prepared&apos;.cong|fact"><span class="entity_def" id="Casper.casper.prepared&apos;.cong|thm"><span class="entity_def" id="Casper.casper.prepared&apos;|const"><span>prepared'</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>prepared'</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>q</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>v1</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>v2</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>v1</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="main"><span class="free"><span>∈<span class="hidden">⇩</span><sub>1</sub></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>q</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><a class="entity_ref" href="Casper.html#Casper.state.prepare_msg|const"><span>prepare_msg</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>v1</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>v2</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Casper.casper.prepared_def|fact"><span class="entity_def" id="Casper.casper.prepared_def|thm"><span class="entity_def" id="Casper.casper.prepared_def_raw|axiom"><span class="entity_def" id="offset_2755..2765">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Casper.casper.prepared.cong|fact"><span class="entity_def" id="Casper.casper.prepared.cong|thm"><span class="entity_def" id="Casper.casper.prepared|const"><span class="entity_def" id="offset_2766..2774">prepared</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>prepared</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>q</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>v1</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>v2</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>v1</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>v2</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>v1</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="main"><span class="free"><span>∈<span class="hidden">⇩</span><sub>1</sub></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>q</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><a class="entity_ref" href="Casper.html#Casper.state.prepare_msg|const"><span>prepare_msg</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>v1</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>v2</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Casper.casper.committed_def|fact"><span class="entity_def" id="Casper.casper.committed_def|thm"><span class="entity_def" id="Casper.casper.committed_def_raw|axiom"><span class="entity_def" id="offset_2869..2879">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Casper.casper.committed.cong|fact"><span class="entity_def" id="Casper.casper.committed.cong|thm"><span class="entity_def" id="Casper.casper.committed|const"><span class="entity_def" id="offset_2880..2889">committed</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>committed</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>q</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>v</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>v</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="main"><span class="free"><span>∈<span class="hidden">⇩</span><sub>1</sub></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>q</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><a class="entity_ref" href="Casper.html#Casper.state.commit_msg|const"><span>commit_msg</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>v</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Casper.casper.fork_def|fact"><span class="entity_def" id="Casper.casper.fork_def|thm"><span class="entity_def" id="Casper.casper.fork_def_raw|axiom"><span class="entity_def" id="offset_2965..2975">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Casper.casper.fork.cong|fact"><span class="entity_def" id="Casper.casper.fork.cong|thm"><span class="entity_def" id="Casper.casper.fork|const"><span class="entity_def" id="offset_2976..2980">fork</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> 
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>fork</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>∃</span></a></span><span> </span><span class="bound"><span>h1</span></span><span> </span><span class="bound"><span>h2</span></span><span> </span><span class="bound"><span>q1</span></span><span> </span><span class="bound"><span>q2</span></span><span> </span><span class="bound"><span>v1</span></span><span> </span><span class="bound"><span>v2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="Casper.html#offset_2880..2889"><span>committed</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="bound"><span>q1</span></span><span> </span><span class="bound"><span>h1</span></span><span> </span><span class="bound"><span>v1</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Casper.html#offset_2880..2889"><span>committed</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="bound"><span>q2</span></span><span> </span><span class="bound"><span>h2</span></span><span> </span><span class="bound"><span>v2</span></span><span>
    </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="main"><span>(</span></span><span class="bound"><span>h2</span></span><span> </span><span class="main"><a class="entity_ref" href="Casper.html#offset_1731..1744"><span>←<span class="hidden">⇧</span><sup>*</sup></span></a></span><span> </span><span class="bound"><span>h1</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="bound"><span>h1</span></span><span> </span><span class="main"><a class="entity_ref" href="Casper.html#offset_1731..1744"><span>←<span class="hidden">⇧</span><sup>*</sup></span></a></span><span> </span><span class="bound"><span>h2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="bound"><span>h1</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="bound"><span>h2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Casper.casper.slashed_1_def|fact"><span class="entity_def" id="Casper.casper.slashed_1_def|thm"><span class="entity_def" id="Casper.casper.slashed_1_def_raw|axiom"><span class="entity_def" id="offset_3109..3119">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Casper.casper.slashed_1.cong|fact"><span class="entity_def" id="Casper.casper.slashed_1.cong|thm"><span class="entity_def" id="Casper.casper.slashed_1|const"><span class="entity_def" id="offset_3120..3129">slashed_1</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>slashed_1</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span>
  </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>∃</span></a></span><span> </span><span class="bound"><span>h</span></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="Casper.html#Casper.state.commit_msg|const"><span>commit_msg</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="bound"><span>h</span></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span> </span><span class="bound"><span>q</span></span><span> </span><span class="bound"><span>v2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="bound"><span>v2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><a class="entity_ref" href="Casper.html#offset_2766..2774"><span>prepared</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="bound"><span>q</span></span><span> </span><span class="bound"><span>h</span></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="bound"><span>v2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Casper.casper.slashed_2_def|fact"><span class="entity_def" id="Casper.casper.slashed_2_def|thm"><span class="entity_def" id="Casper.casper.slashed_2_def_raw|axiom"><span class="entity_def" id="offset_3227..3237">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Casper.casper.slashed_2.cong|fact"><span class="entity_def" id="Casper.casper.slashed_2.cong|thm"><span class="entity_def" id="Casper.casper.slashed_2|const"><span class="entity_def" id="offset_3238..3247">slashed_2</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>slashed_2</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span>
  </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>∃</span></a></span><span> </span><span class="bound"><span>h</span></span><span> </span><span class="bound"><span>v1</span></span><span> </span><span class="bound"><span>v2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="Casper.html#Casper.state.prepare_msg|const"><span>prepare_msg</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="bound"><span>h</span></span><span> </span><span class="bound"><span>v1</span></span><span> </span><span class="bound"><span>v2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>v2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span>
    </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span> </span><span class="bound"><span>v3</span></span><span> </span><span class="bound"><span>q</span></span><span> </span><span class="bound"><span>h2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="bound"><span>v3</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="bound"><span>v2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="Casper.html#offset_2026..2038"><span>nth_ancestor</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>v1</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="bound"><span>v2</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>h2</span></span><span> </span><span class="bound"><span>h</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Casper.html#offset_2766..2774"><span>prepared</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="bound"><span>q</span></span><span> </span><span class="bound"><span>h2</span></span><span> </span><span class="bound"><span>v2</span></span><span> </span><span class="bound"><span>v3</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Casper.casper.slashed_3_def|fact"><span class="entity_def" id="Casper.casper.slashed_3_def|thm"><span class="entity_def" id="Casper.casper.slashed_3_def_raw|axiom"><span class="entity_def" id="offset_3406..3416">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Casper.casper.slashed_3|const"><span>slashed_3</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> 
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>slashed_3</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span>
  </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>∃</span></a></span><span> </span><span class="bound"><span>h1</span></span><span> </span><span class="bound"><span>h2</span></span><span> </span><span class="bound"><span>v1</span></span><span> </span><span class="bound"><span>v2</span></span><span> </span><span class="bound"><span>v3</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><span class="bound"><span>v1</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="bound"><span>v2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>v3</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="bound"><span>v1</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> 
    </span><a class="entity_ref" href="Casper.html#Casper.state.commit_msg|const"><span>commit_msg</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="bound"><span>h1</span></span><span> </span><span class="bound"><span>v1</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Casper.html#Casper.state.prepare_msg|const"><span>prepare_msg</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="bound"><span>h2</span></span><span> </span><span class="bound"><span>v2</span></span><span> </span><span class="bound"><span>v3</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Casper.casper.slashed_4_def|fact"><span class="entity_def" id="Casper.casper.slashed_4_def|thm"><span class="entity_def" id="Casper.casper.slashed_4_def_raw|axiom"><span class="entity_def" id="offset_3548..3558">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Casper.casper.slashed_4|const"><span>slashed_4</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>slashed_4</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>∃</span></a></span><span> </span><span class="bound"><span>h1</span></span><span> </span><span class="bound"><span>h2</span></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="bound"><span>v1</span></span><span> </span><span class="bound"><span>v2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>h1</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span> </span><span class="bound"><span>h2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="bound"><span>v1</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span> </span><span class="bound"><span>v2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> 
    </span><a class="entity_ref" href="Casper.html#Casper.state.prepare_msg|const"><span>prepare_msg</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="bound"><span>h1</span></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="bound"><span>v1</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Casper.html#Casper.state.prepare_msg|const"><span>prepare_msg</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="bound"><span>h2</span></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="bound"><span>v2</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Casper.casper.slashed_def|fact"><span class="entity_def" id="Casper.casper.slashed_def|thm"><span class="entity_def" id="Casper.casper.slashed_def_raw|axiom"><span class="entity_def" id="offset_3690..3700">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Casper.casper.slashed.cong|fact"><span class="entity_def" id="Casper.casper.slashed.cong|thm"><span class="entity_def" id="Casper.casper.slashed|const"><span class="entity_def" id="offset_3701..3708">slashed</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>slashed</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> 
  </span><a class="entity_ref" href="Casper.html#offset_3120..3129"><span>slashed_1</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><a class="entity_ref" href="Casper.html#offset_3238..3247"><span>slashed_2</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><a class="entity_ref" href="Casper.html#Casper.casper.slashed_3|const"><span>slashed_3</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><a class="entity_ref" href="Casper.html#Casper.casper.slashed_4|const"><span>slashed_4</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Casper.casper.one_third_slashed_def|fact"><span class="entity_def" id="Casper.casper.one_third_slashed_def|thm"><span class="entity_def" id="Casper.casper.one_third_slashed_def_raw|axiom"><span class="entity_def" id="offset_3796..3806">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Casper.casper.one_third_slashed.cong|fact"><span class="entity_def" id="Casper.casper.one_third_slashed.cong|thm"><span class="entity_def" id="Casper.casper.one_third_slashed|const"><span class="entity_def" id="offset_3807..3824">one_third_slashed</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>one_third_slashed</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>∃</span></a></span><span> </span><span class="bound"><span>q</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="main"><span class="free"><span>∈<span class="hidden">⇩</span><sub>2</sub></span></span></span><span> </span><span class="bound"><span>q</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><a class="entity_ref" href="Casper.html#offset_3701..3708"><span>slashed</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="bound"><span>n</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemmas</span></span></span><span> </span><span class="entity_def" id="Casper.casper.slashed_defs|fact"><span class="entity_def" id="Casper.casper.slashed_defs(6)|thm"><span class="entity_def" id="Casper.casper.slashed_defs(5)|thm"><span class="entity_def" id="Casper.casper.slashed_defs(4)|thm"><span class="entity_def" id="Casper.casper.slashed_defs(3)|thm"><span class="entity_def" id="Casper.casper.slashed_defs(2)|thm"><span class="entity_def" id="Casper.casper.slashed_defs(1)|thm"><span class="entity_def" id="offset_3897..3909">slashed_defs</span></span></span></span></span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Casper.html#offset_3690..3700"><span>slashed_def</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_3109..3119"><span>slashed_1_def</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_3227..3237"><span>slashed_2_def</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_3548..3558"><span>slashed_4_def</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_3406..3416"><span>slashed_3_def</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_3796..3806"><span>one_third_slashed_def</span></a><span>
</span><span class="keyword1"><span class="command"><span>lemmas</span></span></span><span> </span><span class="entity_def" id="Casper.casper.order_defs|fact"><span class="entity_def" id="Casper.casper.order_defs(8)|thm"><span class="entity_def" id="Casper.casper.order_defs(7)|thm"><span class="entity_def" id="Casper.casper.order_defs(6)|thm"><span class="entity_def" id="Casper.casper.order_defs(5)|thm"><span class="entity_def" id="Casper.casper.order_defs(4)|thm"><span class="entity_def" id="Casper.casper.order_defs(3)|thm"><span class="entity_def" id="Casper.casper.order_defs(2)|thm"><span class="entity_def" id="Casper.casper.order_defs(1)|thm"><span class="entity_def" id="offset_4009..4019">order_defs</span></span></span></span></span></span></span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.class.linorder_axioms_def|fact"><span>class.linorder_axioms_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.class.linorder_def|fact"><span>class.linorder_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.class.order_def|fact"><span>class.order_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.class.preorder_def|fact"><span>class.preorder_def</span></a><span> 
  </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.class.order_axioms_def|fact"><span>class.order_axioms_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.class.order_bot_def|fact"><span>class.order_bot_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.class.order_bot_axioms_def|fact"><span>class.order_bot_axioms_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.linorder_class.linorder_axioms|fact"><span>linorder_axioms</span></a><span class="main"><span>[</span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> </span><span class="tvar"><span>?'a</span></span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a></span><span class="main"><span>]</span></span><span>
</span><span class="keyword1"><span class="command"><span>lemmas</span></span></span><span> </span><span class="entity_def" id="Casper.casper.casper_defs|fact"><span class="entity_def" id="Casper.casper.casper_defs(12)|thm"><span class="entity_def" id="Casper.casper.casper_defs(11)|thm"><span class="entity_def" id="Casper.casper.casper_defs(10)|thm"><span class="entity_def" id="Casper.casper.casper_defs(9)|thm"><span class="entity_def" id="Casper.casper.casper_defs(8)|thm"><span class="entity_def" id="Casper.casper.casper_defs(7)|thm"><span class="entity_def" id="Casper.casper.casper_defs(6)|thm"><span class="entity_def" id="Casper.casper.casper_defs(5)|thm"><span class="entity_def" id="Casper.casper.casper_defs(4)|thm"><span class="entity_def" id="Casper.casper.casper_defs(3)|thm"><span class="entity_def" id="Casper.casper.casper_defs(2)|thm"><span class="entity_def" id="Casper.casper.casper_defs(1)|thm"><span class="entity_def" id="offset_4213..4224">casper_defs</span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Casper.html#offset_3897..3909"><span>slashed_defs</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_2755..2765"><span>prepared_def</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_2965..2975"><span>fork_def</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_2869..2879"><span>committed_def</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_1656..1672"><span>casper_assms_def</span></a><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_4294..4299">lemma</span></span></span><span> </span><span class="entity_def" id="Casper.casper.l1|fact"><span class="entity_def" id="Casper.casper.l1|thm"><span class="entity_def" id="offset_4300..4302">l1</span></span></span><span class="main"><span>:</span></span><span> </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Casper.html#offset_2766..2774"><span>prepared</span></a><span> </span><span class="free"><span>s</span></span><span> </span><span class="free"><span>q1</span></span><span> </span><span class="free"><span>h1</span></span><span> </span><span class="free"><span>v1</span></span><span> </span><span class="free"><span>v2</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Casper.html#offset_2880..2889"><span>committed</span></a><span> </span><span class="free"><span>s</span></span><span> </span><span class="free"><span>q2</span></span><span> </span><span class="free"><span>h2</span></span><span> </span><span class="free"><span>v3</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>v1</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="free"><span>v3</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><a class="entity_ref" href="Casper.html#offset_3807..3824"><span>one_third_slashed</span></a><span> </span><span class="free"><span>s</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>v1</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="free"><span>v2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>v2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>≥</span></a></span><span> </span><span class="free"><span>v3</span></span><span>"</span></span></span><span>
</span><span class="comment1"><span>(*&lt;*)</span></span><span>  </span><span class="keyword1"><span class="command"><span>nitpick</span></span></span><span class="main"><span>[</span></span><span>verbose</span><span class="main"><span>,</span></span><span> card </span><span class="tfree"><span>'b</span></span><span class="main"><span>=</span></span><span>1</span><span class="main"><span>,</span></span><span> card </span><span class="tfree"><span>'c</span></span><span class="main"><span>=</span></span><span>1</span><span class="main"><span>,</span></span><span> card </span><span class="tfree"><span>'a</span></span><span class="main"><span>=</span></span><span>1</span><span class="main"><span>,</span></span><span> card nat</span><span class="main"><span>=</span></span><span>5</span><span class="main"><span>,</span></span><span> card </span><span class="tfree"><span>'h</span></span><span class="main"><span>=</span></span><span>4</span><span class="main"><span>,</span></span><span> card </span><span class="tfree"><span>'d</span></span><span class="main"><span>=</span></span><span>1</span><span class="main"><span>,</span></span><span>
      card </span><span class="quoted"><span>"('a, 'h, 'd) state_scheme"</span></span><span> </span><span class="main"><span>=</span></span><span> 1</span><span class="main"><span>,</span></span><span> dont_box</span><span class="main"><span>,</span></span><span> timeout</span><span class="main"><span>=</span></span><span>300</span><span class="main"><span>,</span></span><span> eval</span><span class="main"><span>=</span></span><span class="quoted"><span>"fork s"</span></span><span class="main"><span>]</span></span><span> </span><span class="comment1"><span>(*&gt;*)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Casper.html#offset_4294..4299"><span>assms</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_1288..1294"><span>casper_axioms</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.linorder_class.linorder_axioms|fact"><span>linorder_axioms</span></a><span class="main"><span>[</span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> </span><span class="tvar"><span>?'a</span></span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Casper.html#offset_4213..4224"><span>casper_defs</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_4009..4019"><span>order_defs</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_4716..4721">lemma</span></span></span><span> </span><span class="entity_def" id="Casper.casper.l2|fact"><span class="entity_def" id="Casper.casper.l2|thm"><span class="entity_def" id="offset_4722..4724">l2</span></span></span><span class="main"><span>:</span></span><span> </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Casper.html#offset_2026..2038"><span>nth_ancestor</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="free"><span>h1</span></span><span> </span><span class="free"><span>h2</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Casper.html#offset_2026..2038"><span>nth_ancestor</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>h2</span></span><span> </span><span class="free"><span>h3</span></span><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Casper.html#offset_2026..2038"><span>nth_ancestor</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="free"><span>m</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>h1</span></span><span> </span><span class="free"><span>h3</span></span><span>"</span></span></span><span> 
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Casper.html#offset_4716..4721"><span>assms</span></a><span> 
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.induct|method"><span class="operator"><span>induct</span></span></a><span> </span><span class="quoted"><span class="free"><span>m</span></span></span><span> </span><span class="quasi_keyword"><span>arbitrary</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span class="free"><span>h1</span></span></span><span> </span><span class="quoted"><span class="free"><span>h2</span></span></span><span> </span><span class="quoted"><span class="free"><span>h3</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>0</span><span> </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Casper.html#offset_2016..2025"><span>nth_ancestor.cases</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>m</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc_eq_plus1|fact"><span>Suc_eq_plus1</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.add_Suc_right|fact"><span>add_Suc_right</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_2016..2025"><span>nth_ancestor.simps</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_2216..2233"><span>nth_ancestor_succ</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_5049..5054">lemma</span></span></span><span> </span><span class="entity_def" id="Casper.casper.l3|fact"><span class="entity_def" id="Casper.casper.l3|thm"><span class="entity_def" id="offset_5055..5057">l3</span></span></span><span class="main"><span>:</span></span><span> </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Casper.html#offset_2766..2774"><span>prepared</span></a><span> </span><span class="free"><span>s</span></span><span> </span><span class="free"><span>q1</span></span><span> </span><span class="free"><span>h1</span></span><span> </span><span class="free"><span>v1</span></span><span> </span><span class="free"><span>v2</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Casper.html#offset_2880..2889"><span>committed</span></a><span> </span><span class="free"><span>s</span></span><span> </span><span class="free"><span>q2</span></span><span> </span><span class="free"><span>h2</span></span><span> </span><span class="free"><span>v3</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>v1</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="free"><span>v3</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><a class="entity_ref" href="Casper.html#offset_3807..3824"><span>one_third_slashed</span></a><span> </span><span class="free"><span>s</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Casper.html#offset_2026..2038"><span>nth_ancestor</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>v1</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>v3</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>h2</span></span><span> </span><span class="free"><span>h1</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Casper.html#offset_5049..5054"><span>assms</span></a><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.induct|method"><span class="operator"><span>induct</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>v1</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>v3</span></span><span>"</span></span></span><span> </span><span class="quasi_keyword"><span>arbitrary</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span class="free"><span>v1</span></span></span><span> </span><span class="quoted"><span class="free"><span>v2</span></span></span><span> </span><span class="quoted"><span class="free"><span>v3</span></span></span><span> </span><span class="quoted"><span class="free"><span>q1</span></span></span><span> </span><span class="quoted"><span class="free"><span>q2</span></span></span><span> </span><span class="quoted"><span class="free"><span>h1</span></span></span><span> </span><span class="quoted"><span class="free"><span>h2</span></span></span><span> </span><span class="quasi_keyword"><span>rule</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.wellorder_class.less_induct|fact"><span>less_induct</span></a><span class="main"><span>)</span></span><span>
    </span><span class="comment1"><span>― ‹ "This is complete induction›</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_5356..5360">less</span><span> </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>v1</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="skolem"><span>v3</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>True</span><span> </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Casper.html#offset_5356..5360"><span>less.prems</span></a><span class="main"><span>(</span></span><span>3</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/lin_arith.ML.html#Fields.linarith|method"><span class="operator"><span>linarith</span></span></a><span>  
    </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
      </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>False</span><span> </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>v2</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="skolem"><span>v3</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
        </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_5559..5563">True</span><span>
        </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>v4</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>q3</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_5591..5592">1</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Casper.html#offset_2766..2774"><span>prepared</span></a><span> </span><span class="free"><span>s</span></span><span> </span><span class="skolem"><span>q3</span></span><span> </span><span class="skolem"><span>h2</span></span><span> </span><span class="skolem"><span>v2</span></span><span> </span><span class="skolem"><span>v4</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="Casper.html#offset_5559..5563"><span>True</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_522..533"><span>byz_quorums_axioms</span></a><span> </span><a class="entity_ref" href="Casper.html#Casper.byz_quorums_def|fact"><span>byz_quorums_def</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_2869..2879"><span>committed_def</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_5356..5360"><span>less.prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>,</span></span></span><span>4</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Casper.html#offset_3796..3806"><span>one_third_slashed_def</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_3109..3119"><span>slashed_1_def</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_3690..3700"><span>slashed_def</span></a><span class="main"><span>)</span></span><span> 
        </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_5775..5779">have</span></span></span><span> </span><span>3</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>h3</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>h2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="skolem"><span>v5</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>v4</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Casper.html#offset_2766..2774"><span>prepared</span></a><span> </span><span class="free"><span>s</span></span><span> </span><span class="skolem"><span>q4</span></span><span> </span><span class="skolem"><span>h3</span></span><span> </span><span class="skolem"><span>v2</span></span><span> </span><span class="skolem"><span>v5</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>q4</span></span><span> </span><span class="skolem"><span>h3</span></span><span> </span><span class="skolem"><span>v5</span></span><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="Casper.html#offset_5591..5592"><span>1</span></a><span>"</span></span><span> </span><a class="entity_ref" href="Casper.html#offset_522..533"><span>byz_quorums_axioms</span></a><span> </span><a class="entity_ref" href="Casper.html#Casper.byz_quorums_def|fact"><span>byz_quorums_def</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_5356..5360"><span>less.prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>4</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Casper.html#offset_3796..3806"><span>one_third_slashed_def</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_2755..2765"><span>prepared_def</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_3548..3558"><span>slashed_4_def</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_3690..3700"><span>slashed_def</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_5775..5779"><span>that</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Casper.html#offset_5356..5360"><span>less</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>,</span></span><span>5</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Casper.html#offset_522..533"><span>byz_quorums_axioms</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_5559..5563"><span>True</span></a><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>only</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Casper.html#offset_4213..4224"><span>casper_defs</span></a><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
        </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_6123..6128">False</span><span>
        </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>q3</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>h3</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>v4</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_6159..6160">1</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Casper.html#offset_2026..2038"><span>nth_ancestor</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>v1</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="skolem"><span>v2</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>h3</span></span><span> </span><span class="skolem"><span>h1</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_6194..6195">2</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Casper.html#offset_2766..2774"><span>prepared</span></a><span> </span><span class="free"><span>s</span></span><span> </span><span class="skolem"><span>q3</span></span><span> </span><span class="skolem"><span>h3</span></span><span> </span><span class="skolem"><span>v2</span></span><span> </span><span class="skolem"><span>v4</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="Casper.html#offset_5356..5360"><span>less.prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1-3</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Casper.html#offset_5049..5054"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>4</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Casper.html#offset_522..533"><span>byz_quorums_axioms</span></a><span> </span><a class="entity_ref" href="Casper.html#Casper.byz_quorums_def|fact"><span>byz_quorums_def</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_2869..2879"><span>committed_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.diff_is_0_eq|fact"><span>diff_is_0_eq</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.cancel_comm_monoid_add_class.diff_zero|fact"><span>diff_zero</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_4300..4302"><span>l1</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_3796..3806"><span>one_third_slashed_def</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_2755..2765"><span>prepared_def</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_3227..3237"><span>slashed_2_def</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_3690..3700"><span>slashed_def</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_6416..6417">3</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Casper.html#offset_2026..2038"><span>nth_ancestor</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>v2</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="skolem"><span>v3</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>h2</span></span><span> </span><span class="skolem"><span>h3</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="Casper.html#offset_6123..6128"><span>False</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_6194..6195"><span>2</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_4300..4302"><span>l1</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.diff_less_mono|fact"><span>diff_less_mono</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_5356..5360"><span>less.hyps</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_5356..5360"><span>less.prems</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.order_class.less_le|fact"><span>less_le</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_6536..6537">4</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>v1</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="skolem"><span>v2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="skolem"><span>v2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>≥</span></a></span><span> </span><span class="skolem"><span>v3</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Casper.html#offset_5049..5054"><span>assms</span></a><span> </span><a class="entity_ref" href="Casper.html#Casper.casper.l1|fact"><span>casper.l1</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_1288..1294"><span>casper_axioms</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_5356..5360"><span>less.prems</span></a><span class="main"><span>(</span></span><span>1-3</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span>
        </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Casper.html#offset_6159..6160"><span>1</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_6416..6417"><span>3</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_6536..6537"><span>4</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_5356..5360"><span>less.prems</span></a><span class="main"><span>(</span></span><span>3</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Casper.html#offset_4722..4724"><span>l2</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.force|method"><span class="operator"><span>force</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_6707..6712">lemma</span></span></span><span> </span><span class="entity_def" id="Casper.casper.l4|fact"><span class="entity_def" id="Casper.casper.l4|thm"><span class="entity_def" id="offset_6713..6715">l4</span></span></span><span class="main"><span>:</span></span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Casper.html#offset_2026..2038"><span>nth_ancestor</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="free"><span>h1</span></span><span> </span><span class="free"><span>h2</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>h1</span></span><span> </span><span class="main"><a class="entity_ref" href="Casper.html#offset_1731..1744"><span>←<span class="hidden">⇧</span><sup>*</sup></span></a></span><span> </span><span class="free"><span>h2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="free"><span>h1</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>h2</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Casper.html#offset_6707..6712"><span>assms</span></a><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.induct|method"><span class="operator"><span>induct</span></span></a><span> </span><span class="quoted"><span class="free"><span>n</span></span></span><span> </span><span class="quasi_keyword"><span>arbitrary</span></span><span class="main"><span class="main"><span>:</span></span></span><span class="quoted"><span class="free"><span>h1</span></span></span><span> </span><span class="quoted"><span class="free"><span>h2</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>0</span><span> </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Casper.html#offset_2277..2292"><span>zeroth_ancestor</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity_def" id="offset_6888..6891">Suc</span><span> </span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>h3</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_6913..6914">1</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>h3</span></span><span> </span><span class="main"><span class="free"><span>←</span></span></span><span> </span><span class="skolem"><span>h2</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_6929..6930">2</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Casper.html#offset_2026..2038"><span>nth_ancestor</span></a><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="skolem"><span>h1</span></span><span> </span><span class="skolem"><span>h3</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Casper.html#offset_2216..2233"><span>nth_ancestor_succ</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_6888..6891"><span>Suc.prems</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc_eq_plus1|fact"><span>Suc_eq_plus1</span></a><span class="main"><span>)</span></span><span> 
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Casper.html#offset_6888..6891"><span>Suc.hyps</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Casper.html#offset_6929..6930"><span>2</span></a><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Casper.html#offset_6913..6914"><span>1</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_1877..1897"><span>hash_ancestor_intro'</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span> 
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_7085..7090">lemma</span></span></span><span> </span><span class="entity_def" id="Casper.casper.safety|fact"><span class="entity_def" id="Casper.casper.safety|thm"><span>safety</span></span></span><span class="main"><span>:</span></span><span> </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Casper.html#offset_2976..2980"><span>fork</span></a><span> </span><span class="free"><span>s</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Casper.html#offset_3807..3824"><span>one_third_slashed</span></a><span> </span><span class="free"><span>s</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>h1</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>h2</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>q1</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>q2</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>v1</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>v2</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_7185..7186">1</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Casper.html#offset_2880..2889"><span>committed</span></a><span> </span><span class="free"><span>s</span></span><span> </span><span class="skolem"><span>q1</span></span><span> </span><span class="skolem"><span>h1</span></span><span> </span><span class="skolem"><span>v1</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_7214..7215">2</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Casper.html#offset_2880..2889"><span>committed</span></a><span> </span><span class="free"><span>s</span></span><span> </span><span class="skolem"><span>q2</span></span><span> </span><span class="skolem"><span>h2</span></span><span> </span><span class="skolem"><span>v2</span></span><span>"</span></span></span><span> 
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_7248..7249">3</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>h2</span></span><span> </span><span class="main"><a class="entity_ref" href="Casper.html#offset_1731..1744"><span>←<span class="hidden">⇧</span><sup>*</sup></span></a></span><span> </span><span class="skolem"><span>h1</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="skolem"><span>h1</span></span><span> </span><span class="main"><a class="entity_ref" href="Casper.html#offset_1731..1744"><span>←<span class="hidden">⇧</span><sup>*</sup></span></a></span><span> </span><span class="skolem"><span>h2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="skolem"><span>h1</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>h2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Casper.html#offset_7085..7090"><span>assms</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_2965..2975"><span>fork_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_7325..7326">4</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="Casper.html#offset_2026..2038"><span>nth_ancestor</span></a><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="skolem"><span>h1</span></span><span> </span><span class="skolem"><span>h2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><a class="entity_ref" href="Casper.html#offset_2026..2038"><span>nth_ancestor</span></a><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="skolem"><span>h2</span></span><span> </span><span class="skolem"><span>h1</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="skolem"><span>h1</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>h2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Casper.html#offset_6713..6715"><span>l4</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_7248..7249"><span>3</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
  </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>q3</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>q4</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>v3</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>v4</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_7438..7439">5</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Casper.html#offset_2766..2774"><span>prepared</span></a><span> </span><span class="free"><span>s</span></span><span> </span><span class="skolem"><span>q3</span></span><span> </span><span class="skolem"><span>h1</span></span><span> </span><span class="skolem"><span>v1</span></span><span> </span><span class="skolem"><span>v3</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_7469..7470">6</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Casper.html#offset_2766..2774"><span>prepared</span></a><span> </span><span class="free"><span>s</span></span><span> </span><span class="skolem"><span>q4</span></span><span> </span><span class="skolem"><span>h2</span></span><span> </span><span class="skolem"><span>v2</span></span><span> </span><span class="skolem"><span>v4</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><a class="entity_ref" href="Casper.html#offset_3807..3824"><span>one_third_slashed</span></a><span> </span><span class="free"><span>s</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Casper.html#offset_7185..7186"><span>1</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_7214..7215"><span>2</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="Casper.html#offset_522..533"><span>byz_quorums_axioms</span></a><span> </span><a class="entity_ref" href="Casper.html#Casper.byz_quorums_def|fact"><span>byz_quorums_def</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_2869..2879"><span>committed_def</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_3796..3806"><span>one_third_slashed_def</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_3109..3119"><span>slashed_1_def</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_3690..3700"><span>slashed_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> 
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>v1</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>v2</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_7695..7699">True</span><span>
    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Casper.html#offset_7185..7186"><span>1</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_7325..7326"><span>4</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_7214..7215"><span>2</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_7438..7439"><span>5</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_7469..7470"><span>6</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_7695..7699"><span>True</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_1288..1294"><span>casper_axioms</span></a><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Casper.html#Casper.byz_quorums_def|fact"><span>byz_quorums_def</span></a><span> </span><a class="entity_ref" href="Casper.html#Casper.casper_def|fact"><span>casper_def</span></a><span>  </span><a class="entity_ref" href="Casper.html#offset_3690..3700"><span>slashed_def</span></a><span>
      </span><a class="entity_ref" href="Casper.html#offset_3796..3806"><span>one_third_slashed_def</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_1288..1294"><span>casper_axioms</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_2869..2879"><span>committed_def</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_2755..2765"><span>prepared_def</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_3109..3119"><span>slashed_1_def</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_3548..3558"><span>slashed_4_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>False</span><span> </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Casper.html#offset_5055..5057"><span>l3</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_7185..7186"><span>1</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_7214..7215"><span>2</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_7325..7326"><span>4</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_7438..7439"><span>5</span></a><span> </span><a class="entity_ref" href="Casper.html#offset_7469..7470"><span>6</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.order_class.less_le|fact"><span>less_le</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.linorder_class.not_less|fact"><span>not_less</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
</span></pre>
</body>

</html>